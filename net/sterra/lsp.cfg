\#   This is automatically generated LSP
#
#   Conversion Date/Time:   Fri Jan 25 15:51:25 2019

GlobalParameters(
    Title                       = "This LSP was automatically generated by CSP Converter at Fri Jan 25 15:51:25 2019"
    Version                     = LSP_4_2
    PreserveIPsecSA             = FALSE
)

IKEParameters(
    FragmentSize = 0
)

RoutingTable(
    Routes =
        Route(
            Destination = 0.0.0.0/0
            Gateway = 40.40.40.254
        )
)

FirewallParameters(
    TCPSynSentTimeout = 30
    TCPFinTimeout = 5
    TCPClosedTimeout = 30
    TCPSynRcvdTimeout = 30
    TCPEstablishedTimeout = 3600
    TCPHalfOpenLow = 400
    TCPHalfOpenMax = 500
    TCPSessionRateLow = 400
    TCPSessionRateMax = 500
)

IKETransform crypto:isakmp:policy:1
(
    CipherAlg   = "G2814789CPRO1-K256-CBC-65534"
    HashAlg     = "GR341112_256TC26-65128"
    GroupID     = VKO2_1B
    RestrictAuthenticationTo = PRESHARED
    LifetimeSeconds = 86400
)

ESPProposal TSET:ESP
(
    Transform* = ESPTransform
    (
        CipherAlg*          = "G2814789CPRO2-K288-CNTMAC-253"
        LifetimeSeconds     = 3600
        LifetimeKilobytes   = 4608000
    )
)

AuthMethodPreshared Preshared:20_20_20_1
(
    LocalID  = IdentityEntry( KeyID = "475732" )
    RemoteID = IdentityEntry(
        IPv4Address = 20.20.20.1
    )
    SharedIKESecret = "cs_key_20_20_20_1"
)

IKERule IKERule:CMAP:1
(
    IKEPeerIPFilter = 20.20.20.1
    Transform = crypto:isakmp:policy:1
    AggrModeAuthMethod  = Preshared:20_20_20_1
    MainModeAuthMethod  = Preshared:20_20_20_1
    DPDIdleDuration     = 1
    DPDResponseDuration = 3
    DPDRetries          = 3
    Priority            = 10
)

IPsecAction IPsecAction:CMAP:1
(
    TunnelingParameters = TunnelEntry(
        PeerAddress = 20.20.20.1
        DFHandling=COPY
        Assemble=TRUE
    )
    ContainedProposals = ( TSET:ESP )
    GroupID = VKO2_1B
    IKERule = IKERule:CMAP:1
)

FilterChain IPsecPolicy:CMAP (
    Filters = Filter (
        ProtocolID = 17
        SourcePort = 500, 4500
        Action = PASS
        PacketType = LOCAL_UNICAST, LOCAL_MISDIRECTED
    ),
    Filter (
        SourceIP = 192.168.1.0/24
        DestinationIP = 192.168.100.0/24
        Action = PASS
        ExtendedAction = ipsec< sa = IPsecAction:CMAP:1 >
        LogEventID = "IPsec:Protect:CMAP:1:LIST"
    )
)

NetworkInterface (
    LogicalName = "FastEthernet0/0"
    IPsecPolicy = IPsecPolicy:CMAP
)
